# テストケース詳細仕様書

## 目次
1. [機能テストケース](#機能テストケース)
2. [パフォーマンステストケース](#パフォーマンステストケース)
3. [セキュリティテストケース](#セキュリティテストケース)
4. [アクセシビリティテストケース](#アクセシビリティテストケース)
5. [E2Eテストケース](#e2eテストケース)
6. [テストデータ](#テストデータ)

---

## 機能テストケース

### 1. 問い合わせフォーム機能

#### TC-F001: 正常な問い合わせ送信
- **テストID**: TC-F001
- **優先度**: 高
- **カテゴリ**: 機能テスト
- **目的**: 有効なデータで問い合わせが正常に送信されることを確認
- **前提条件**: 
  - アプリケーションが正常に起動している
  - データベースが利用可能
- **テストデータ**: 
  ```json
  {
    "name": "テスト太郎",
    "email": "test@example.com",
    "phone": "090-1234-5678",
    "message": "体験レッスンについて詳しく教えてください。平日の夕方に参加希望です。",
    "lesson_type": "trial",
    "preferred_contact": "email"
  }
  ```
- **実行手順**:
  1. 問い合わせページ（/contact）にアクセス
  2. 名前フィールドに「テスト太郎」を入力
  3. メールアドレスフィールドに「test@example.com」を入力
  4. 電話番号フィールドに「090-1234-5678」を入力
  5. メッセージフィールドにテストメッセージを入力
  6. レッスンタイプで「体験レッスン」を選択
  7. 希望連絡方法で「メール」を選択
  8. 送信ボタンをクリック
- **期待結果**:
  - HTTP 200レスポンスが返される
  - 「お問い合わせを受け付けました」メッセージが表示される
  - データベースに問い合わせレコードが作成される
  - contact_idが返される
  - 作成日時が設定される

#### TC-F002: 必須フィールド未入力エラー
- **テストID**: TC-F002
- **優先度**: 高
- **カテゴリ**: 機能テスト（バリデーション）
- **目的**: 必須フィールドが未入力の場合にエラーが表示されることを確認
- **前提条件**: 問い合わせページが表示されている
- **テストデータ**: 
  ```json
  {
    "name": "",
    "email": "",
    "message": ""
  }
  ```
- **実行手順**:
  1. 問い合わせページにアクセス
  2. 全フィールドを空のまま送信ボタンをクリック
- **期待結果**:
  - HTTP 422レスポンスが返される
  - 「名前は必須です」エラーメッセージが表示される
  - 「メールアドレスは必須です」エラーメッセージが表示される
  - 「メッセージは必須です」エラーメッセージが表示される
  - フォームが送信されない

#### TC-F003: 無効なメールアドレスエラー
- **テストID**: TC-F003
- **優先度**: 中
- **カテゴリ**: 機能テスト（バリデーション）
- **目的**: 無効なメールアドレス形式でエラーが表示されることを確認
- **テストデータ**: 
  ```json
  {
    "name": "テスト太郎",
    "email": "invalid-email",
    "message": "テストメッセージ"
  }
  ```
- **実行手順**:
  1. 問い合わせページにアクセス
  2. 名前に「テスト太郎」を入力
  3. メールアドレスに「invalid-email」を入力
  4. メッセージに「テストメッセージ」を入力
  5. 送信ボタンをクリック
- **期待結果**:
  - HTTP 422レスポンスが返される
  - 「有効なメールアドレスを入力してください」エラーメッセージが表示される

#### TC-F004: 文字数制限エラー
- **テストID**: TC-F004
- **優先度**: 中
- **カテゴリ**: 機能テスト（バリデーション）
- **目的**: 文字数制限を超えた場合にエラーが表示されることを確認
- **テストデータ**: 
  ```json
  {
    "name": "あ".repeat(101),
    "email": "test@example.com",
    "message": "あ".repeat(1001)
  }
  ```
- **期待結果**:
  - 「名前は100文字以内で入力してください」エラーメッセージが表示される
  - 「メッセージは1000文字以内で入力してください」エラーメッセージが表示される

### 2. 管理者認証機能

#### TC-F005: 管理者ログイン成功
- **テストID**: TC-F005
- **優先度**: 高
- **カテゴリ**: 機能テスト（認証）
- **目的**: 有効な認証情報でログインが成功することを確認
- **前提条件**: 管理者アカウントが作成済み
- **テストデータ**: 
  ```json
  {
    "username_or_email": "admin@test.com",
    "password": "testpassword123"
  }
  ```
- **実行手順**:
  1. 管理者ログインページ（/admin/login）にアクセス
  2. ユーザー名/メールアドレスに「admin@test.com」を入力
  3. パスワードに「testpassword123」を入力
  4. ログインボタンをクリック
- **期待結果**:
  - HTTP 200レスポンスが返される
  - JWTアクセストークンが取得される
  - JWTリフレッシュトークンが取得される
  - 管理者ダッシュボード（/admin/dashboard）にリダイレクトされる
  - トークンの有効期限が設定される

#### TC-F006: 管理者ログイン失敗
- **テストID**: TC-F006
- **優先度**: 高
- **カテゴリ**: 機能テスト（認証）
- **目的**: 無効な認証情報でログインが失敗することを確認
- **テストデータ**: 
  ```json
  {
    "username_or_email": "invalid@test.com",
    "password": "wrongpassword"
  }
  ```
- **実行手順**:
  1. 管理者ログインページにアクセス
  2. 無効な認証情報を入力
  3. ログインボタンをクリック
- **期待結果**:
  - HTTP 401レスポンスが返される
  - 「ユーザー名またはパスワードが正しくありません」エラーメッセージが表示される
  - ログインページに留まる

#### TC-F007: トークンリフレッシュ
- **テストID**: TC-F007
- **優先度**: 中
- **カテゴリ**: 機能テスト（認証）
- **目的**: リフレッシュトークンで新しいアクセストークンが取得できることを確認
- **前提条件**: 有効なリフレッシュトークンを保持している
- **実行手順**:
  1. 有効なリフレッシュトークンを使用
  2. `/api/auth/refresh`にPOSTリクエスト
- **期待結果**:
  - HTTP 200レスポンスが返される
  - 新しいアクセストークンが取得される
  - トークンタイプが「bearer」である

### 3. 問い合わせ管理機能

#### TC-F008: 問い合わせ一覧取得
- **テストID**: TC-F008
- **優先度**: 高
- **カテゴリ**: 機能テスト（管理機能）
- **目的**: 管理者が問い合わせ一覧を取得できることを確認
- **前提条件**: 管理者としてログイン済み、問い合わせデータが存在
- **実行手順**:
  1. 認証トークンを取得
  2. `/api/admin/contacts`にGETリクエスト
- **期待結果**:
  - HTTP 200レスポンスが返される
  - 問い合わせリストが取得される
  - ページネーション情報が含まれる
  - 各問い合わせに必要な情報が含まれる（id, name, email, status等）

#### TC-F009: 問い合わせ詳細取得
- **テストID**: TC-F009
- **優先度**: 高
- **カテゴリ**: 機能テスト（管理機能）
- **目的**: 特定の問い合わせの詳細情報を取得できることを確認
- **前提条件**: 管理者としてログイン済み、問い合わせデータが存在
- **実行手順**:
  1. 認証トークンを取得
  2. `/api/admin/contacts/{contact_id}`にGETリクエスト
- **期待結果**:
  - HTTP 200レスポンスが返される
  - 指定した問い合わせの詳細情報が取得される
  - 全ての問い合わせフィールドが含まれる

#### TC-F010: 問い合わせステータス更新
- **テストID**: TC-F010
- **優先度**: 高
- **カテゴリ**: 機能テスト（管理機能）
- **目的**: 問い合わせのステータスが更新できることを確認
- **前提条件**: 管理者としてログイン済み、更新対象の問い合わせが存在
- **テストデータ**: 
  ```json
  {
    "status": "in_progress",
    "admin_notes": "対応開始しました"
  }
  ```
- **実行手順**:
  1. 認証トークンを取得
  2. `/api/admin/contacts/{contact_id}`にPUTリクエスト
  3. ステータスと管理者メモを送信
- **期待結果**:
  - HTTP 200レスポンスが返される
  - データベースのステータスが更新される
  - 更新日時が記録される

### 4. システム監視機能

#### TC-F011: ヘルスチェック
- **テストID**: TC-F011
- **優先度**: 高
- **カテゴリ**: 機能テスト（監視）
- **目的**: システムの健全性が確認できることを確認
- **前提条件**: アプリケーションが起動している
- **実行手順**:
  1. `/api/monitoring/health`にGETリクエスト
- **期待結果**:
  - HTTP 200レスポンスが返される
  - システム状態情報が取得される
  - データベース接続状態が確認できる
  - 各コンポーネントの状態が「healthy」である

#### TC-F012: システム統計取得
- **テストID**: TC-F012
- **優先度**: 中
- **カテゴリ**: 機能テスト（監視）
- **目的**: システム統計情報が取得できることを確認
- **前提条件**: 管理者としてログイン済み
- **実行手順**:
  1. 認証トークンを取得
  2. `/api/monitoring/stats`にGETリクエスト
- **期待結果**:
  - HTTP 200レスポンスが返される
  - 問い合わせ件数統計が取得される
  - システムリソース使用量が取得される

---

## パフォーマンステストケース

### 1. 応答時間テスト

#### TC-P001: ヘルスチェック応答時間
- **テストID**: TC-P001
- **優先度**: 高
- **カテゴリ**: パフォーマンステスト
- **目的**: ヘルスチェックエンドポイントの応答時間を測定
- **実行条件**: 10回連続実行
- **合格基準**:
  - 平均応答時間: < 500ms
  - 最大応答時間: < 1000ms
  - 成功率: 100%
- **測定項目**:
  - レスポンス時間
  - スループット
  - エラー率
- **実行手順**:
  1. `/api/monitoring/health`に10回連続でGETリクエスト
  2. 各リクエストの応答時間を測定
  3. 統計値を計算

#### TC-P002: 問い合わせフォーム応答時間
- **テストID**: TC-P002
- **優先度**: 高
- **カテゴリ**: パフォーマンステスト
- **目的**: 問い合わせフォーム送信の応答時間を測定
- **実行条件**: 20回連続実行
- **合格基準**:
  - 平均応答時間: < 2000ms
  - 最大応答時間: < 5000ms
  - 成功率: 100%
- **実行手順**:
  1. 有効な問い合わせデータで20回連続送信
  2. 各リクエストの応答時間を測定
  3. データベース書き込み時間も含めて測定

#### TC-P003: 管理者API応答時間
- **テストID**: TC-P003
- **優先度**: 中
- **カテゴリ**: パフォーマンステスト
- **目的**: 管理者API群の応答時間を測定
- **実行条件**: 各API 10回実行
- **合格基準**:
  - 問い合わせ一覧取得: < 3000ms
  - 問い合わせ詳細取得: < 1000ms
  - ステータス更新: < 2000ms
- **実行手順**:
  1. 管理者としてログイン
  2. 各APIエンドポイントを10回実行
  3. 応答時間を測定

### 2. 負荷テスト

#### TC-P004: 同時接続テスト
- **テストID**: TC-P004
- **優先度**: 高
- **カテゴリ**: パフォーマンステスト（負荷）
- **目的**: 同時接続時のシステム性能を確認
- **実行条件**: 50同時リクエスト
- **合格基準**:
  - 全リクエスト成功
  - 処理時間: < 10秒
  - スループット: > 10 req/s
  - エラー率: 0%
- **実行手順**:
  1. 50個の並列プロセスを起動
  2. 各プロセスから問い合わせフォームに送信
  3. 全体の処理時間とエラー率を測定

#### TC-P005: ストレステスト
- **テストID**: TC-P005
- **優先度**: 中
- **カテゴリ**: パフォーマンステスト（負荷）
- **目的**: システムの限界性能を確認
- **実行条件**: 段階的負荷増加（10, 25, 50, 100同時接続）
- **合格基準**:
  - 50同時接続まで正常動作
  - レスポンス時間の劣化が線形以下
- **実行手順**:
  1. 10同時接続から開始
  2. 段階的に負荷を増加
  3. 各段階でのパフォーマンス指標を記録

### 3. メモリ・リソーステスト

#### TC-P006: メモリリークテスト
- **テストID**: TC-P006
- **優先度**: 中
- **カテゴリ**: パフォーマンステスト（リソース）
- **目的**: 長時間実行時のメモリ使用量安定性を確認
- **実行条件**: 200リクエスト実行
- **合格基準**:
  - メモリ増加量: < 100MB
  - メモリリークなし
- **実行手順**:
  1. 初期メモリ使用量を記録
  2. 200回の問い合わせ送信を実行
  3. 実行後のメモリ使用量を測定
  4. メモリ増加量を計算

#### TC-P007: データベース接続プールテスト
- **テストID**: TC-P007
- **優先度**: 中
- **カテゴリ**: パフォーマンステスト（リソース）
- **目的**: データベース接続プールの効率性を確認
- **実行条件**: 100並列データベースアクセス
- **合格基準**:
  - 接続プール枯渇なし
  - 接続待機時間: < 1000ms
- **実行手順**:
  1. 100並列でデータベースアクセス
  2. 接続プールの使用状況を監視
  3. 接続待機時間を測定

### 4. Lighthouseパフォーマンステスト

#### TC-P008: ホームページパフォーマンス
- **テストID**: TC-P008
- **優先度**: 高
- **カテゴリ**: パフォーマンステスト（Web）
- **目的**: ホームページのWebパフォーマンスを測定
- **測定項目**:
  - Performance Score: ≥ 80
  - Accessibility Score: ≥ 90
  - Best Practices Score: ≥ 80
  - SEO Score: ≥ 80
- **実行手順**:
  1. Lighthouseでホームページを測定
  2. 各スコアを記録
  3. 改善提案を確認

#### TC-P009: 問い合わせページパフォーマンス
- **テストID**: TC-P009
- **優先度**: 高
- **カテゴリ**: パフォーマンステスト（Web）
- **目的**: 問い合わせページのWebパフォーマンスを測定
- **測定項目**: TC-P008と同様
- **実行手順**:
  1. Lighthouseで問い合わせページを測定
  2. フォーム操作のパフォーマンスも確認

---

## セキュリティテストケース

### 1. インジェクション攻撃テスト

#### TC-S001: SQLインジェクション攻撃
- **テストID**: TC-S001
- **優先度**: 高
- **カテゴリ**: セキュリティテスト
- **目的**: SQLインジェクション攻撃への耐性を確認
- **攻撃パターン**:
  ```sql
  '; DROP TABLE contacts; --
  ' OR '1'='1
  '; SELECT * FROM admins; --
  ' UNION SELECT password FROM admins --
  ```
- **テスト対象**: 全ての入力フィールド
- **実行手順**:
  1. 各攻撃パターンを入力フィールドに送信
  2. レスポンスとデータベース状態を確認
- **合格基準**: 攻撃が成功しない（正常処理またはバリデーションエラー）

#### TC-S002: XSS攻撃
- **テストID**: TC-S002
- **優先度**: 高
- **カテゴリ**: セキュリティテスト
- **目的**: クロスサイトスクリプティング攻撃への耐性を確認
- **攻撃パターン**:
  ```html
  <script>alert('XSS')</script>
  <img src=x onerror=alert('XSS')>
  javascript:alert('XSS')
  <svg onload=alert('XSS')>
  ```
- **実行手順**:
  1. 各攻撃パターンを入力
  2. ページ表示時の動作を確認
- **合格基準**: スクリプトが実行されない

#### TC-S003: コマンドインジェクション
- **テストID**: TC-S003
- **優先度**: 中
- **カテゴリ**: セキュリティテスト
- **目的**: OSコマンドインジェクション攻撃への耐性を確認
- **攻撃パターン**:
  ```bash
  ; ls -la
  && cat /etc/passwd
  | whoami
  ```
- **合格基準**: コマンドが実行されない

### 2. 認証・認可テスト

#### TC-S004: 認証バイパス
- **テストID**: TC-S004
- **優先度**: 高
- **カテゴリ**: セキュリティテスト
- **目的**: 認証機能のバイパス攻撃への耐性を確認
- **攻撃パターン**:
  - 無効なトークン
  - 改ざんされたトークン
  - 期限切れトークン
  - 空のAuthorizationヘッダー
- **実行手順**:
  1. 各パターンで管理者APIにアクセス
  2. レスポンスを確認
- **合格基準**: 全て401エラーで拒否される

#### TC-S005: 権限昇格
- **テストID**: TC-S005
- **優先度**: 高
- **カテゴリ**: セキュリティテスト
- **目的**: 権限昇格攻撃への耐性を確認
- **実行手順**:
  1. 一般ユーザーとしてログイン
  2. 管理者専用機能にアクセス試行
- **合格基準**: 403エラーで拒否される

#### TC-S006: セッション管理
- **テストID**: TC-S006
- **優先度**: 中
- **カテゴリ**: セキュリティテスト
- **目的**: セッション管理の安全性を確認
- **テスト項目**:
  - セッション固定攻撃
  - セッションハイジャック
  - 同時ログイン制御
- **合格基準**: 適切なセッション管理が実装されている

### 3. CSRF攻撃テスト

#### TC-S007: CSRF攻撃
- **テストID**: TC-S007
- **優先度**: 高
- **カテゴリ**: セキュリティテスト
- **目的**: クロスサイトリクエストフォージェリ攻撃への耐性を確認
- **実行手順**:
  1. 異なるOriginから状態変更リクエストを送信
  2. CSRFトークンなしでリクエスト送信
- **合格基準**: CSRF攻撃が防がれる

### 4. ブルートフォース攻撃テスト

#### TC-S008: ブルートフォース攻撃
- **テストID**: TC-S008
- **優先度**: 高
- **カテゴリ**: セキュリティテスト
- **目的**: ブルートフォース攻撃への耐性を確認
- **実行手順**:
  1. 短時間で多数のログイン試行
  2. 異なるパスワードで連続試行
- **合格基準**: レート制限が適用される

### 5. セキュリティヘッダーテスト

#### TC-S009: セキュリティヘッダー
- **テストID**: TC-S009
- **優先度**: 中
- **カテゴリ**: セキュリティテスト
- **目的**: 必要なセキュリティヘッダーが設定されていることを確認
- **確認項目**:
  - `X-Content-Type-Options: nosniff`
  - `X-Frame-Options: DENY`
  - `X-XSS-Protection: 1; mode=block`
  - `Referrer-Policy: strict-origin-when-cross-origin`
  - `Content-Security-Policy`
- **実行手順**:
  1. 各ページのHTTPヘッダーを確認
  2. セキュリティヘッダーの存在と値を検証
- **合格基準**: 全ての必要なヘッダーが適切に設定されている

---

## アクセシビリティテストケース

### 1. キーボードナビゲーション

#### TC-A001: キーボード操作
- **テストID**: TC-A001
- **優先度**: 高
- **カテゴリ**: アクセシビリティテスト
- **目的**: キーボードのみでの操作が可能であることを確認
- **テスト内容**:
  - Tabキーでのフォーカス移動
  - Enterキーでのボタン実行
  - Escapeキーでのモーダル閉じる
  - 矢印キーでのナビゲーション
- **実行手順**:
  1. マウスを使用せずにキーボードのみで操作
  2. 全ての機能にアクセス可能か確認
  3. フォーカス順序が論理的か確認
- **合格基準**: 全ての機能がキーボードで操作可能

#### TC-A002: フォーカス管理
- **テストID**: TC-A002
- **優先度**: 高
- **カテゴリ**: アクセシビリティテスト
- **目的**: フォーカス管理が適切に実装されていることを確認
- **テスト内容**:
  - フォーカスの可視性
  - フォーカストラップ（モーダル内）
  - フォーカス復帰（モーダル閉じた後）
- **合格基準**: フォーカスが適切に管理されている

### 2. スクリーンリーダー対応

#### TC-A003: ARIA属性
- **テストID**: TC-A003
- **優先度**: 高
- **カテゴリ**: アクセシビリティテスト
- **目的**: スクリーンリーダーが適切に情報を読み上げられることを確認
- **確認項目**:
  - `aria-label`属性の設定
  - `aria-describedby`属性の設定
  - `role`属性の適切な使用
  - `alt`属性の設定
- **実行手順**:
  1. スクリーンリーダー（NVDA/JAWS）で操作
  2. 読み上げ内容が適切か確認
- **合格基準**: WCAG 2.1 AA基準に準拠

#### TC-A004: 見出し構造
- **テストID**: TC-A004
- **優先度**: 中
- **カテゴリ**: アクセシビリティテスト
- **目的**: 見出し構造が論理的であることを確認
- **確認項目**:
  - h1からh6の適切な階層
  - 見出しレベルの飛び越しなし
  - ページごとの適切な見出し構造
- **合格基準**: 見出し構造が論理的で一貫している

### 3. 色・コントラスト

#### TC-A005: 色覚対応
- **テストID**: TC-A005
- **優先度**: 高
- **カテゴリ**: アクセシビリティテスト
- **目的**: 色覚に依存しない情報伝達ができることを確認
- **テスト内容**:
  - 色のみに依存した情報伝達の確認
  - エラー表示の色以外の手がかり
  - 必須フィールドの色以外の表示
- **実行手順**:
  1. 色覚シミュレーターで確認
  2. グレースケールで表示確認
- **合格基準**: 色に依存しない情報伝達が実現されている

#### TC-A006: コントラスト比
- **テストID**: TC-A006
- **優先度**: 高
- **カテゴリ**: アクセシビリティテスト
- **目的**: 適切なコントラスト比が確保されていることを確認
- **測定項目**:
  - 通常テキスト: 4.5:1以上
  - 大きなテキスト: 3:1以上
  - UI要素: 3:1以上
- **実行手順**:
  1. コントラスト測定ツールで確認
  2. 各色の組み合わせを測定
- **合格基準**: WCAG 2.1 AA基準のコントラスト比を満たす

### 4. フォームアクセシビリティ

#### TC-A007: フォームラベル
- **テストID**: TC-A007
- **優先度**: 高
- **カテゴリ**: アクセシビリティテスト
- **目的**: フォーム要素が適切にラベル付けされていることを確認
- **確認項目**:
  - `label`要素の適切な関連付け
  - `placeholder`の適切な使用
  - 必須フィールドの明示
  - エラーメッセージの関連付け
- **合格基準**: 全てのフォーム要素が適切にラベル付けされている

---

## E2Eテストケース

### 1. ユーザージャーニーテスト

#### TC-E001: 問い合わせ完了フロー
- **テストID**: TC-E001
- **優先度**: 高
- **カテゴリ**: E2Eテスト
- **目的**: ユーザーが問い合わせを完了できることを確認
- **実行手順**:
  1. ホームページ（/）にアクセス
  2. 「お問い合わせ」ボタンをクリック
  3. 問い合わせページ（/contact）に移動
  4. フォームに有効なデータを入力
  5. 送信ボタンをクリック
  6. 完了メッセージを確認
- **期待結果**:
  - エラーなく完了する
  - 適切なページ遷移が行われる
  - 成功メッセージが表示される
- **合格基準**: 全ての手順がエラーなく完了する

#### TC-E002: 管理者ログイン〜問い合わせ確認フロー
- **テストID**: TC-E002
- **優先度**: 高
- **カテゴリ**: E2Eテスト
- **目的**: 管理者が問い合わせを確認・管理できることを確認
- **実行手順**:
  1. 管理者ログインページ（/admin/login）にアクセス
  2. 有効な認証情報でログイン
  3. 管理者ダッシュボードに移動
  4. 問い合わせ一覧を確認
  5. 特定の問い合わせの詳細を表示
  6. ステータスを更新
- **合格基準**: 管理者機能が正常に動作する

### 2. レスポンシブテスト

#### TC-E003: マルチデバイス対応
- **テストID**: TC-E003
- **優先度**: 高
- **カテゴリ**: E2Eテスト（レスポンシブ）
- **目的**: 各デバイスで適切に表示されることを確認
- **テスト環境**:
  - モバイル: 375px × 667px (iPhone SE)
  - タブレット: 768px × 1024px (iPad)
  - デスクトップ: 1920px × 1080px
- **実行手順**:
  1. 各画面サイズでページを表示
  2. レイアウトの崩れがないか確認
  3. 操作性に問題がないか確認
- **合格基準**: 全デバイスで適切に表示・操作できる

#### TC-E004: タッチ操作対応
- **テストID**: TC-E004
- **優先度**: 中
- **カテゴリ**: E2Eテスト（レスポンシブ）
- **目的**: タッチデバイスでの操作性を確認
- **テスト内容**:
  - タップ操作
  - スワイプ操作
  - ピンチズーム
- **合格基準**: タッチ操作が適切に動作する

### 3. ブラウザ互換性テスト

#### TC-E005: クロスブラウザテスト
- **テストID**: TC-E005
- **優先度**: 高
- **カテゴリ**: E2Eテスト（互換性）
- **対象ブラウザ**:
  - Chrome (最新版)
  - Firefox (最新版)
  - Safari (最新版)
  - Edge (最新版)
- **実行手順**:
  1. 各ブラウザで主要機能をテスト
  2. 表示の違いを確認
  3. JavaScript動作を確認
- **合格基準**: 全ブラウザで正常動作

### 4. パフォーマンステスト（E2E）

#### TC-E006: ページ読み込み速度
- **テストID**: TC-E006
- **優先度**: 中
- **カテゴリ**: E2Eテスト（パフォーマンス）
- **目的**: 実際のユーザー環境でのページ読み込み速度を確認
- **測定項目**:
  - First Contentful Paint (FCP)
  - Largest Contentful Paint (LCP)
  - Cumulative Layout Shift (CLS)
- **合格基準**: Core Web Vitalsの基準を満たす

---

## テストデータ

### 1. 有効なテストデータ

#### 問い合わせデータ
```json
{
  "valid_contact_1": {
    "name": "テスト太郎",
    "email": "test@example.com",
    "phone": "090-1234-5678",
    "message": "体験レッスンについて詳しく教えてください。",
    "lesson_type": "trial",
    "preferred_contact": "email"
  },
  "valid_contact_2": {
    "name": "Test Hanako",
    "email": "hanako@test.co.jp",
    "phone": "080-9876-5432",
    "message": "グループレッスンの料金について知りたいです。",
    "lesson_type": "group",
    "preferred_contact": "phone"
  },
  "valid_contact_minimal": {
    "name": "最小太郎",
    "email": "minimal@test.com",
    "message": "最小限の情報でのテストです。"
  }
}
```

#### 管理者アカウント
```json
{
  "admin_account": {
    "username": "admin",
    "email": "admin@test.com",
    "password": "testpassword123",
    "role": "admin"
  },
  "test_admin": {
    "username": "testadmin",
    "email": "testadmin@example.com",
    "password": "securepassword456",
    "role": "admin"
  }
}
```

### 2. 無効なテストデータ

#### バリデーションエラー用データ
```json
{
  "empty_fields": {
    "name": "",
    "email": "",
    "message": ""
  },
  "invalid_email": {
    "name": "テスト太郎",
    "email": "invalid-email",
    "message": "テストメッセージ"
  },
  "too_long_fields": {
    "name": "あ".repeat(101),
    "email": "test@example.com",
    "message": "あ".repeat(1001)
  },
  "invalid_phone": {
    "name": "テスト太郎",
    "email": "test@example.com",
    "phone": "invalid-phone",
    "message": "テストメッセージ"
  }
}
```

### 3. セキュリティテスト用データ

#### SQLインジェクション攻撃パターン
```json
{
  "sql_injection_patterns": [
    "'; DROP TABLE contacts; --",
    "' OR '1'='1",
    "'; SELECT * FROM admins; --",
    "' UNION SELECT password FROM admins --",
    "admin'--",
    "admin' /*",
    "' or 1=1#",
    "' or 1=1--",
    "' or 1=1/*"
  ]
}
```

#### XSS攻撃パターン
```json
{
  "xss_patterns": [
    "<script>alert('XSS')</script>",
    "<img src=x onerror=alert('XSS')>",
    "javascript:alert('XSS')",
    "<svg onload=alert('XSS')>",
    "<iframe src=javascript:alert('XSS')>",
    "<body onload=alert('XSS')>",
    "<input onfocus=alert('XSS') autofocus>",
    "<select onfocus=alert('XSS') autofocus>"
  ]
}
```

### 4. パフォーマンステスト用データ

#### 負荷テスト用データ
```json
{
  "load_test_contacts": [
    {
      "name": "負荷テスト1",
      "email": "load1@test.com",
      "message": "負荷テスト用のメッセージ1"
    },
    {
      "name": "負荷テスト2", 
      "email": "load2@test.com",
      "message": "負荷テスト用のメッセージ2"
    }
  ]
}
```

### 5. 境界値テストデータ

#### 文字数境界値
```json
{
  "boundary_values": {
    "name_max": "あ".repeat(100),
    "name_over": "あ".repeat(101),
    "message_max": "あ".repeat(1000),
    "message_over": "あ".repeat(1001),
    "email_max": "a".repeat(244) + "@test.com",
    "phone_valid": "090-1234-5678",
    "phone_min": "090-123-4567",
    "phone_max": "090-1234-56789"
  }
}
```

---

## 付録

### A. テスト実行チェックリスト

#### 事前準備
- [ ] Docker環境の確認
- [ ] 環境変数の設定
- [ ] テストデータベースの準備
- [ ] 依存関係のインストール

#### 機能テスト
- [ ] 問い合わせフォーム機能
- [ ] 管理者認証機能
- [ ] 問い合わせ管理機能
- [ ] システム監視機能

#### 非機能テスト
- [ ] パフォーマンステスト
- [ ] セキュリティテスト
- [ ] アクセシビリティテスト
- [ ] E2Eテスト

#### 事後処理
- [ ] テスト結果の記録
- [ ] 環境のクリーンアップ
- [ ] レポートの生成

### B. 参考資料

- [WCAG 2.1 ガイドライン](https://www.w3.org/WAI/WCAG21/quickref/)
- [OWASP Testing Guide](https://owasp.org/www-project-web-security-testing-guide/)
- [Lighthouse Performance Auditing](https://developers.google.com/web/tools/lighthouse)
- [Playwright Documentation](https://playwright.dev/)
- [Jest Testing Framework](https://jestjs.io/)
- [FastAPI Testing](https://fastapi.tiangolo.com/tutorial/testing/)

---

**文書作成者**: 開発チーム  
**最終更新日**: 2024年12月14日  
**承認者**: プロジェクトマネージャー